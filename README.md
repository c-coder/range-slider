# RegExp

<https://www.regular-expressions.info> - документация на английском.

[regExr.com](https://regexr.com/) - конструктор (браузер - js & сервер PHP/PCRE)  
[pagecolumn.com](https://regexr.com/) - конструктор JS и PHP

***
### Флаги [(модификаторы)](https://www.regular-expressions.info/modifiers.html)

В js записываются после выражения: `/regexp/flags`  
В Fiddler (.NET) - перед: `(?flags)regexp`

JS  
i - ignoreCase (регистронезависимый)  
g - global (все совпадения)  
m - multiLine (многострочый режим) - *изменяет поведение границ (^ и $)*
```js
var regExp = /.+/igm;
```


FIDDLER  
n - превращает все неименованные группы в группы без захвата.  
s - в однострочном режиме делает '.' совпадением со всеми символами, включая разрыв строк (\r\n)  
x - режим свободного пробела [пробельные символы игнорируются, но не '\ d'](https://www.regular-expressions.info/freespacing.html)

```
(?insx)regexp
```

***
### Границы
```js
^ // /^A/ ==>'A', если с неё начинается текст (строка при установленном флаге /^0/m)
$ // /A$/ ==>'A', если это последний символ в тексте (строке, при флаге /m)

\b // граница слова.
<!-- С русским языком не работает! Только символы \w ! -->
/\bjava\b/ // Шаблон соответствует 'java' только если это слово целиком
// т.е. окружено пробельными символами, а точнее символами \W ==> 'java!' тоже подойдет
```

***
### Символ (литерал, набор, диапазон, класс)
```js
/a/ // литерал, соответствует 'a'

// набор
/[123]a/ // 1a, 2a, 3a

// диапазон
/[1-3]/ // 1, 2, 3

// набор + диапазон (по номерам Unicode)
/[1-3a-c]/ // 1, 2, 3, a, b, c

/[^123] // любой символ, кроме 1, 2, 3
```
*Для экранирования используется символ '\\'*   
*Внутри [ ] можно НЕ экранировать:*  

- . + ( ) [

- \- если он в начале или конце

- ^ если не в начале

### Короткая запись диапазонов (классы символов)
```js
\d => [0-9] 
\D => [^0-9]

\w => [a-zA-z0-9_] 
\W => [^\w]

\s // пробел, табуляция, символы перевода строк
\S // НЕ пробельный символ

. // любой символ, кроме символов первода строк (\r \n )
[^] // вообще любой символ в js, но в PCRE не работает - приводит к ошибке!
```

***
### Квантификаторы
Используются с символами и группами ( )

```js
/\w{5}/ // 5 любых символов подряд

/\w{3,5}/ // от 3 до 5 любых символов подряд

/\w{3,}/ // от 3 любых символов подряд
```

*Короткая запись часто используемых квантификаторов:*
```js
+ // ==> {1,} Один или несколько символов(групп) ( /\w+/ = /\w{1,} )
* // ==> {0,} 0 или несколько
? // ==> {0,1} Может быть, а может нет (0 или 1 раз)
```
#### Режимы квантификации
исходная строка для поиска
```
<p>Text</p>
```
1. **Жадная** *(greedy)*  
    включена по умолчанию 
    ```js
    /<[^]*>/g
    ```
    <span style="background: blue">&lt;p&gt;Text&lt;/p&gt;</span> *- найдет максимально длинный вариант*
    1. найден символ <
    2. [^] дойдет до конца текста (ведь любой символ)
    3. откатится на 1 символ назад (циклично) пока не найдет >

0. **Ленивая** *(lazy)*  
    включается добавлением "?" после квантификатора (напр. +?, *?, ??, {0,5}?)
    ```js
    /<[^]*?>/g
    ```
    <span style="background: blue">&lt;p&gt;</span>Text<span style="background: blue">&lt;/p&gt;</span> *- найдет самый короткий(е) вариант*
    1. найден символ <
    2. [^] после каждого совпадения, будет проверять оставшуюся часть шаблона (за квантификатором).
    > Здесь можно добится того же результата при жадной квантификации, изменив шаблон на /<[^>]*>/g


0. **Сверхжадная** или ревнивая *(possesive)*  
    = жадная без отката (3-го шага)  
    в js НЕ реализована. 

***
### Альтернация
```js
| - или

/red|green|\d{3}/g // red или green или 123 (и любое 3-значное число)

/авто(страда|бан)/g // скобки задают границы альтернации
```

***
### Предпросмотр (Lookahead)
(?=..regExp) - просматривает, но не включает совпадение в результат.
```js
/java(?=Script)/g // java, если за ним следует Script (positive)
```
java <span style="background: blue">java</span>Script
```js
/java(?!=Script)/g // java, если за ним НЕ следует Script (negative)
```
<span style="background: blue">java</span> javaScript

***
### Скобочная группа
Используется для группировки части шаблона с целью
- квантификации  /(mur)+/g
- доступа к части совпадения по номеру скабочной группы (с 1 слева-направо)
> ! Группа (?: ...) не получает номер
```js
// Необходимо найти в тексте строку в кавычках. 
// Кавычки могут быть одинарными '...' или двойными "..."

/['"](.*?)['"]/ // найдет не только "..." и '...', но и "...', '..."
/(['"])(.*?)\1/ // найдет только парные кавычки

// \1 будет заменео либо на ' либо на " (на сопоставление для скобочной группы №1)
```
